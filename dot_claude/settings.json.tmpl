{
  "defaultMode": "plan",
  "includeCoAuthoredBy": false,
  "env": {
    "CLAUDE_BASH_MAINTAIN_PROJECT_WORKING_DIR": "1"
  },
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash(git push*)",
        "hooks": [
          {
            "type": "command",
{{- if eq .chezmoi.os "windows" }}
            "command": "Write-Host '[Hook] Review changes before push. Press Enter to continue or Ctrl+C to abort...' -ForegroundColor Yellow; Read-Host | Out-Null"
{{- else }}
            "command": "echo '[Hook] Review changes before push. Press Enter to continue or Ctrl+C to abort...' >&2 && read -r"
{{- end }}
          }
        ]
      },
      {
        "matcher": "Write(*.md)",
        "hooks": [
          {
            "type": "command",
{{- if eq .chezmoi.os "windows" }}
            "command": "$input = $Input | Out-String; $json = $input | ConvertFrom-Json; $file_path = $json.tool_input.file_path; if ($file_path -match '\\.(md|txt)$' -and $file_path -notmatch '(README|CLAUDE|AGENTS|CONTRIBUTING|SKILL)\\.md$' -and $file_path -notmatch '[/\\\\]skills[/\\\\]') { Write-Error '[Hook] BLOCKED: Arbitrary documentation file creation'; Write-Error \"[Hook] File: $file_path\"; Write-Error '[Hook] Use README.md, CLAUDE.md, AGENTS.md, or CONTRIBUTING.md instead'; exit 1 }; Write-Output $input"
{{- else }}
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\nif [[ \"$file_path\" =~ \\.(md|txt)$ ]] && [[ ! \"$file_path\" =~ (README|CLAUDE|AGENTS|CONTRIBUTING|SKILL)\\.md$ ]] && [[ ! \"$file_path\" =~ /skills/ ]]; then\n  echo \"[Hook] BLOCKED: Arbitrary documentation file creation\" >&2\n  echo \"[Hook] File: $file_path\" >&2\n  echo \"[Hook] Use README.md, CLAUDE.md, AGENTS.md, or CONTRIBUTING.md instead\" >&2\n  exit 1\nfi\necho \"$input\""
{{- end }}
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Edit(*.ts)|Edit(*.tsx)|Edit(*.js)|Edit(*.jsx)",
        "hooks": [
          {
            "type": "command",
{{- if eq .chezmoi.os "windows" }}
            "command": "$input = $Input | Out-String; $json = $input | ConvertFrom-Json; $file_path = $json.tool_input.file_path; if ($file_path -and (Test-Path $file_path)) { $matches = Select-String -Path $file_path -Pattern 'console\\.log' -AllMatches; if ($matches) { Write-Warning \"[Hook] WARNING: console.log found in $file_path\"; $matches | Select-Object -First 5 | ForEach-Object { Write-Warning $_.Line }; Write-Warning '[Hook] Remove console.log before committing' } }; Write-Output $input"
{{- else }}
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\nif [ -n \"$file_path\" ] && [ -f \"$file_path\" ]; then\n  console_logs=$(grep -n \"console\\\\.log\" \"$file_path\" 2>/dev/null || true)\n  if [ -n \"$console_logs\" ]; then\n    echo \"[Hook] WARNING: console.log found in $file_path\" >&2\n    echo \"$console_logs\" | head -5 >&2\n    echo \"[Hook] Remove console.log before committing\" >&2\n  fi\nfi\necho \"$input\""
{{- end }}
          }
        ]
      }
    ]
  },
  "permissions": {
    "allow": [
      "Read(**)",
      "Edit(**)",
      "Write(**)",
      "Glob(**)",
      "Grep(**)",
      "Bash(git:*)",
      "Bash(tree:*)",
      "Bash(find:*)"
    ],
    "deny": [
      "Bash(shutdown)",
      "Bash(reboot)",
      "Bash(halt)",
      "Bash(poweroff)",
      "Bash(mkfs)",
      "Bash(dd)",
      "Bash(fdisk)",
      "Bash(parted)",
      "Bash(sudo)",
      "Bash(doas)",
      "Bash(su)"
    ],
    "ask": [
      "Bash(rm)",
      "Bash(chmod)",
      "Bash(chown)",
      "Bash(kill)",
      "Bash(git reset --hard)",
      "Bash(git push --force)"
    ]
  },
  "statusLine": {
    "type": "command",
{{- if eq .chezmoi.os "windows" }}
    "command": "pwsh -NoProfile -File {{ .chezmoi.homeDir | replace "\\" "\\\\" }}/.claude/statusline.ps1"
{{- else }}
    "command": "bash ~/.claude/statusline.sh"
{{- end }}
  }
}
